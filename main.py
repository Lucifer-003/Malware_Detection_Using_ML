import os
import time
import pyfiglet

def run_PE():
    file = input("Enter the path and name of the file to scan for malware: ")
    if os.path.exists(file):
        os.system(f"python3 Extract/PE_main.py {file}")
    else:
        print(f"Error: The file '{file}' does not exist.")
        time.sleep(2)

def run_URL():
    url = input("Enter the URL to scan for malware: ")
    # Assuming 'url_main.py' handles URL input within the script
    os.system(f'python3 Extract/url_main.py {url}')

def exit_program():
    print("Exiting the program. Goodbye!")
    time.sleep(2)
    os._exit(0)

def start():
    print(pyfiglet.figlet_format("Malware Detector"))
    print(" Welcome to the antimalware detector \n")
    print(" 1. PE scanner")
    print(" 2. URL scanner")
    print(" 3. Exit\n")

    try:
        select = int(input("Enter your choice (1/2/3): "))
    except ValueError:
        print("Invalid input. Please enter a valid number (1, 2, or 3).")
        time.sleep(2)
        start()
        return  # Ensure function terminates correctly after restarting

    if select == 1:
        run_PE()
        ask_retry()

    elif select == 2:
        run_URL()
        ask_retry()

    elif select == 3:
        exit_program()

    else:
        print("Invalid choice. Please select 1, 2, or 3.")
        time.sleep(2)
        start()

def ask_retry():
    choice = input("Do you want to perform another scan? (y/n): ").lower()
    if choice == 'y':
        start()
    elif choice == 'n':
        exit_program()
    else:
        print("Invalid input. Exiting...")
        time.sleep(2)
        exit_program()

start()
